### <center> 数学建模第一次作业<center>

##### 队伍编号：16

##### 队伍成员：廖立彬(25)，徐畅(27)，梁轶凡(38)，刘洋(51)



1. #### 问题分析:

   根据我们已知的物理知识，火箭脱离地球需要达到一定的速度，因此我们考虑火箭分级的出发点是，在保证火箭速度的情况下，如何使成本更低，也就是使质量比（结构与燃料在总质量中的占比）更小。

2. #### 模型假设

   1. 火箭燃料燃烧产生的推力远大于空气阻力和火箭所受重力等外阻力之和，因此火箭的加速过程满足动量定理，可以使用火箭公式来进行推导
   1. 火箭的气体喷射速度不变
   2. 相同质量的结构所能承载的燃料质量是相同的，即燃料质量与结构质量成正比

3. #### 模型建立

    首先求解这个问题需要用到**齐奥尔科夫斯基火箭公式** $\Delta v = u\ln(\frac{m_0}{m_1})$，u为火箭排气速度，$m_0$是加速前火箭质量，$m_1$是加速后火箭质量，$\Delta v$是火箭速度增量。

    $记m_p为火箭有效载荷，m_i为第i级火箭的结构和燃料的总质量，\lambda为结构比(结构质量在燃料和结构总质量中的占比)$

    因此第i级中结构质量为$\lambda m_i$，燃料质量为$ (1 - \lambda)m_i$，对于n级火箭，$m_0 = m_p + m_1 + m_2 + ... + m_n$

    第一级火箭点燃，
    $$
    \Delta v_1 = u\ln(\frac{m_0}{m_p + \lambda m_1 + m_2 + ... +m_n})
    $$
    第二级火箭点燃，
    $$
    \Delta v_2 = u\ln(\frac{m_p + m_2 + m_3 + ... + m_n}{m_p + \lambda m_2 + m_3 + ... +m_n})
    $$
    ......

    第n级火箭点燃，
    $$
    \Delta v_n = u\ln(\frac{m_p + m_n}{m_p + \lambda m_n})
    $$
    所以，最终有
    $$
    v = u \ln(\frac{m_0}{m_p + \lambda m_1 + m_2 + ... +m_n} * \frac{m_p + m_2 + m_3 + ... + m_n}{m_p + \lambda m_2 + m_3 + ... +m_n}*\cdot\cdot\cdot*\frac{m_p + m_n}{m_p + \lambda m_n})
    $$
    
4. #### 模型求解

    在上述表达式中，$v, u, \lambda, m_p$可以看作是已知量，在已知这些的情况下，我们需要求解的是，在火箭级数为多少的时候载荷质量比(载荷质量在总质量中的占比)取得一个最小值，显然这是一个带约束的极值问题，我们尝试对约束进行化简，以便我们进行求解。

    记
    $$
    a = \frac{m_p + m_i + ... + m_n}{m_p + m_{i + 1} + ... +m_n}
    $$
    那么有
    $$
    \frac{m_0}{m_p} = \frac{m_p + m_1 + ... + m_n}{m_p + m_2 + ... + m_n} * \frac{m_p + m_2 + ... + m_n}{m_p + m_3 + ... + m_n} * \cdot\cdot\cdot * \frac{m_p + m_n}{m_p} = \prod_{i = 1}^{i = n}a_i \\
    v = u\ln(\frac{a_1}{1 + \lambda(a_1 - 1)}*\cdot\cdot\cdot*\frac{a_n}{1 + \lambda(a_n - 1)})
    $$
    再引入变量$x_i$，并再次对约束函数和目标函数进行变换
    $$
    x_i = \frac{1 + \lambda(a_i - 1)}{a_i}\\ v = u\ln(\frac{1}{x_1*x_2*\cdots*x_n}) ==> x_1x_2\cdots x_n = e^{-\frac{v}{u}}(约束条件)\\
    \frac{m_0}{m_p} = \frac{(1 - \lambda)^n}{(x_1 - \lambda)(x_2 - \lambda)\cdots(x_n - \lambda)}(目标函数)
    $$
    使用**拉格朗日乘子法**对其进行求解
    $$
    令f(x_1, x_2, \cdots,x_n) = \frac{(1 - \lambda)^n}{(x_1 - \lambda)(x_2 - \lambda)\cdots(x_n - \lambda)} + p(x_1x_2\cdots x_n - e^{-\frac{v}{u}})\\
    求f的偏微分：\frac{\partial f}{\partial p} = x_1x_2\cdots x_n - e^{-\frac{v}{u}} \qquad \frac{\partial f}{\partial x_i} = -\frac{1}{x_i - \lambda}\frac{(1 - \lambda)^n}{(x_1 - \lambda)(x_2 - \lambda)\cdots(x_n - \lambda)} + px_1x_2\cdots x_{i - 1}x_{i + 1}\cdots x_n \\ 令\frac{\partial f}{\partial p} = 0, \frac{\partial f}{\partial x_i} = 0\\即：x_1x_2\cdots x_n = e^{-\frac{v}{u}},\quad (x_1 - \lambda)x_2\cdots x_n = x_1(x_2 - \lambda)x_3\cdots x_n = x_1x_2\cdots(x_n - \lambda) \\解得，当x_1 = x_2 = \cdots = x_n = e^{-\frac{v}{nu}}时，目标函数\frac{m_0}{m_p}取得极小值(\frac{1 - \lambda}{e^{-\frac{v}{nu}} - \lambda})^n
    $$
    火箭的最终速度v要达到第一宇宙速度**7.9 km/s**，才能完成运送卫星进入轨道的任务；

    火箭的排气速度能达到同样能达到千米每秒的水平，我们以3 km\s作为一个参考值；

    火箭的结构比是一个在0到1之间的数，在保证安全的情况下，结构比越小越好，目前火箭的结构系数大约为0.1

    在已知以上这些条件后，我们来计算当n取不同值时，目标函数的值

    |         n         |   2   |  3   |  4   |  5   | $\cdots$ | $\infty$ |
    | :---------------: | :---: | :--: | :--: | :--: | :------: | :------: |
    | $\frac{m_0}{m_p}$ | 28.69 |  23  |  21  |  20  | $\cdots$ |    18    |

    当v取7.9 km/s时，结果还不是很明显，事实上，第一宇宙速度仅仅是卫星近地环绕的速度，根据卫星的环绕半径的变换，卫星的速度可以在第一宇宙速度(7.9 km/s)和第二宇宙速度(11.2 km/s)之间变化，我们不妨取一个稍大一些的值来进行计算，当**v = 10.2 km/s**时

    |         n         |  2   |  3   |  4   |  5   | $\cdots$ | $\infty$ |
    | :---------------: | :--: | :--: | :--: | :--: | :------: | :------: |
    | $\frac{m_0}{m_p}$ | 118  |  66  |  57  |  53  | $\cdots$ |    43    |

    我们再取**v = 11.2 km/s**来进行计算

    |         n         |  2   |  3   |  4   |  5   | $\cdots$ | $\infty$ |
    | :---------------: | :--: | :--: | :--: | :--: | :------: | :------: |
    | $\frac{m_0}{m_p}$ | 271  | 109  |  88  |  80  | $\cdots$ |    63    |

5. #### 模型结论

    从上述分析中可以看到，三级火箭相对于二级火箭来说，质量比$\frac{m_0}{m_p}$有较为显著的降低，而四级火箭和五级火箭，虽然质量比也有所降低，但降低幅度不大。实现火箭级数的增加不仅有技术上的困难，还要考虑到安全方面的问题以及成本的提高，因此三级火箭是在兼顾安全，技术与成本三方面的情况下的一个最优方案



